# üîÑ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—é –±—ç–∫–µ–Ω–¥–∞

## üìã –ß—Ç–æ –±—ã–ª–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ

–î–æ–±–∞–≤–ª–µ–Ω –Ω–æ–≤—ã–π API endpoint –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ç—Ä–µ–Ω–¥–æ–≤:
- **URL**: `GET /api/analytics/trends`
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Ç—Ä–µ–Ω–¥–æ–≤ –ø–æ —Ç–∏–ø—É —Å–µ–Ω—Å–æ—Ä–∞ —Å –∞–Ω–∞–ª–∏–∑–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–π

---

## üöÄ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –±—ç–∫–µ–Ω–¥–∞

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ start_backend.bat

```bash
# 1. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ç–µ–∫—É—â–∏–π –ø—Ä–æ—Ü–µ—Å—Å –±—ç–∫–µ–Ω–¥–∞ (Ctrl+C)
# 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∑–∞–Ω–æ–≤–æ:
start_backend.bat
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –í—Ä—É—á–Ω—É—é

```bash
# 1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é backend
cd backend

# 2. –ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
venv\Scripts\activate

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ endpoint

### 1. –ß–µ—Ä–µ–∑ curl (PowerShell)

```powershell
# –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
$response = Invoke-RestMethod -Uri "http://localhost:8000/api/auth/login" `
  -Method POST `
  -ContentType "application/x-www-form-urlencoded" `
  -Body "username=admin&password=admin123"

$token = $response.access_token

# –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ trends endpoint
Invoke-RestMethod -Uri "http://localhost:8000/api/analytics/trends?sensor_type=raw_material&period=24h" `
  -Headers @{ "Authorization" = "Bearer $token" } | ConvertTo-Json -Depth 10
```

### 2. –ß–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä

1. –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:8000/docs
2. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ "Authorize" (–∑–∞–º–æ–∫ –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É)
3. –õ–æ–≥–∏–Ω: `admin`, –ü–∞—Ä–æ–ª—å: `admin123`
4. –ù–∞–π–¥–∏—Ç–µ endpoint `GET /api/analytics/trends`
5. –ù–∞–∂–º–∏—Ç–µ "Try it out"
6. –£–∫–∞–∂–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
   - `sensor_type`: `raw_material`
   - `period`: `24h`
7. –ù–∞–∂–º–∏—Ç–µ "Execute"

---

## üìä –ü–∞—Ä–∞–º–µ—Ç—Ä—ã endpoint

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ:
- **sensor_type** (string): –¢–∏–ø —Å–µ–Ω—Å–æ—Ä–∞
  - `raw_material` - –°—ã—Ä—å–µ
  - `production_line` - –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–∞—è –ª–∏–Ω–∏—è
  - `warehouse` - –°–∫–ª–∞–¥

### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ:
- **period** (string, default: "24h"): –ü–µ—Ä–∏–æ–¥ –∞–Ω–∞–ª–∏–∑–∞
  - `1h` - –ü–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å
  - `24h` - –ü–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞
  - `7d` - –ü–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π
  - `30d` - –ü–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π

- **start_date** (string, ISO format): –ù–∞—á–∞–ª—å–Ω–∞—è –¥–∞—Ç–∞
- **end_date** (string, ISO format): –ö–æ–Ω–µ—á–Ω–∞—è –¥–∞—Ç–∞  
- **metric** (string): –ö–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

---

## üì§ –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞

```json
{
  "metrics": [
    {"key": "temperature", "name": "Temperature"},
    {"key": "humidity", "name": "Humidity"}
  ],
  "overview": [
    {
      "timestamp": "2025-11-18T10:00:00",
      "parameter": "temperature",
      "value": 25.5,
      "name": "Temperature"
    }
  ],
  "detailed": [
    {
      "title": "Temperature",
      "dataKey": "value",
      "name": "temperature",
      "data": [
        {
          "timestamp": "2025-11-18T10:00:00",
          "value": 25.5,
          "unit": "¬∞C",
          "is_anomaly": false
        }
      ]
    }
  ],
  "summary": [
    {
      "name": "Temperature",
      "change": 5.2
    }
  ]
}
```

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

–ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –±—ç–∫–µ–Ω–¥–∞:

1. **–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥** (http://localhost:3000)
2. **–í–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É** (admin / admin123)
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞** - –æ—à–∏–±–∫–∏ 404 –¥–ª—è `/api/analytics/trends` –¥–æ–ª–∂–Ω—ã –∏—Å—á–µ–∑–Ω—É—Ç—å
4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ Network tab** - –∑–∞–ø—Ä–æ—Å—ã –∫ `/api/analytics/trends` –¥–æ–ª–∂–Ω—ã –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Å—Ç–∞—Ç—É—Å `200 OK`

---

## üêõ Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: Endpoint –Ω–µ –Ω–∞–π–¥–µ–Ω (404)

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# 1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±—ç–∫–µ–Ω–¥ –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω
# 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –±—ç–∫–µ–Ω–¥–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫
# 3. –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:8000/docs –∏ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ endpoint "GET /api/analytics/trends" –µ—Å—Ç—å –≤ —Å–ø–∏—Å–∫–µ
```

### –ü—Ä–æ–±–ª–µ–º–∞: 401 Unauthorized

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü–æ–ª—É—á–∏—Ç–µ –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
# –¢–æ–∫–µ–Ω—ã –∏–º–µ—é—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è (–æ–±—ã—á–Ω–æ 30 –º–∏–Ω—É—Ç)
```

### –ü—Ä–æ–±–ª–µ–º–∞: 500 Internal Server Error

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –±—ç–∫–µ–Ω–¥–∞ –≤ –∫–æ–Ω—Å–æ–ª–∏
# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–æ—Å—Ç—É–ø–Ω–∞
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ —Ç–∞–±–ª–∏—Ü–µ sensor_data
```

---

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- Endpoint —Ç—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (Bearer token)
- Endpoint –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã—á–∏—Å–ª—è–µ—Ç –ø—Ä–æ—Ü–µ–Ω—Ç–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–ª—è –∫–∞–∂–¥–æ–π –º–µ—Ç—Ä–∏–∫–∏
- –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –ø—É—Å—Ç–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (–Ω–µ –æ—à–∏–±–∫–∞)
- Endpoint –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –ø–æ –¥–∞—Ç–∞–º –∏ –º–µ—Ç—Ä–∏–∫–∞–º

---

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è endpoint:

1. ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
2. ‚úÖ –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç TrendsPanel –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ
3. ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –Ω–µ—Ç –æ—à–∏–±–æ–∫ –≤ –∫–æ–Ω—Å–æ–ª–∏
4. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Ä–∞–∑–ª–∏—á–Ω—ã–µ –ø–µ—Ä–∏–æ–¥—ã (1h, 24h, 7d, 30d)

**Endpoint –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** ‚ú®

