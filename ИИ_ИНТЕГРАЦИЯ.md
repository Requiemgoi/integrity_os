# Документация для интеграции ИИ в Dashboard

## Обзор

Графики и визуализации удалены со страницы дашборда. Все данные загружаются и готовы к использованию ИИ. Структура компонентов подготовлена для будущей интеграции ИИ-генерации контента.

## Компоненты, подготовленные для ИИ

### 1. DashboardTab Component (`components/DashboardTab.js`)

**Назначение:** Отображение данных сенсоров для выбранного типа (сырье, производственная линия, склад).

**Доступные данные для ИИ:**
```javascript
{
  sensorData: Array,        // Все точки данных за последние 24 часа
  latestData: Array,        // Последние значения для каждого параметра
  dataByParameter: Object,  // Данные, сгруппированные по параметрам
  parameters: Array,        // Уникальные параметры (temperature, humidity, etc.)
  summary: Object,          // Сводная информация о сенсорах
  sensorType: String        // Тип сенсора ('raw_material', 'production_line', 'warehouse')
}
```

**Структура данных:**

**sensorData:**
```javascript
[
  {
    id: number,
    sensor_id: string,
    sensor_type: string,
    parameter: string,      // 'temperature', 'humidity', 'vibration', etc.
    value: number,
    unit: string,           // '°C', '%', 'mm/s', etc.
    timestamp: string,      // ISO date string
    is_anomaly: boolean
  },
  // ...
]
```

**latestData:**
```javascript
[
  {
    parameter: string,
    value: number,
    unit: string,
    timestamp: string
  },
  // ...
]
```

**dataByParameter:**
```javascript
{
  'temperature': [/* массив точек данных */],
  'humidity': [/* массив точек данных */],
  // ...
}
```

**summary:**
```javascript
{
  sensor_count: number,
  recent_data_points: number,
  active_alerts: number
}
```

**Функции для использования:**
- `loadData()`: загружает данные сенсоров (автоматически вызывается)
- WebSocket подключение: автоматически обновляет данные в реальном времени

**Область для ИИ-генерации:**
Функция `renderAIGeneratedContent()` - здесь ИИ должен генерировать визуализации и анализ.

**Что должен генерировать ИИ:**
- Графики и диаграммы на основе sensorData
- Аналитические инсайты на основе данных
- Рекомендации на основе трендов
- Предупреждения и алерты

---

### 2. KPICards Component (`components/KPICards.js`)

**Назначение:** Отображение KPI (ключевых показателей эффективности).

**Доступные данные для ИИ:**
```javascript
{
  kpis: Array  // Массив объектов KPI
}
```

**Структура данных kpis:**
```javascript
[
  {
    id: number,
    kpi_name: string,       // 'OEE', 'stock_level', 'production_rate'
    value: number,          // Текущее значение
    target: number,         // Целевое значение (опционально)
    unit: string,           // Единица измерения ('%', 'units', etc.)
    timestamp: string       // ISO date string
  },
  // ...
]
```

**Функции для использования:**
- Данные загружаются через `dashboardService.getKPIs()` (автоматически)
- Данные обновляются через WebSocket (автоматически)

**Область для ИИ-генерации:**
Функция `renderAIGeneratedKPIs()` - здесь ИИ должен генерировать визуализации KPI.

**Что должен генерировать ИИ:**
- Визуализации KPI (графики, индикаторы прогресса)
- Анализ трендов
- Сравнение с целевыми значениями
- Рекомендации по улучшению показателей

---

## Сервисы для работы с данными

### sensorService (`services/sensorService.js`)

```javascript
// Получить типы сенсоров
await sensorService.getSensorTypes()

// Получить данные сенсоров
await sensorService.getSensorData(sensorType, hours, limit)
// sensorType: 'raw_material' | 'production_line' | 'warehouse'
// hours: количество часов (по умолчанию 24)
// limit: максимальное количество точек (по умолчанию 1000)

// Получить последние данные
await sensorService.getLatestSensorData(sensorType)

// Симулировать данные (для тестирования)
await sensorService.simulateSensorData(sensorType)
```

### dashboardService (`services/dashboardService.js`)

```javascript
// Получить KPI
await dashboardService.getKPIs()

// Получить алерты
await dashboardService.getAlerts(limit)

// Получить сводку
await dashboardService.getSummary()

// Сгенерировать KPI
await dashboardService.generateKPIs()
```

### websocketService (`services/websocketService.js`)

```javascript
// Подключиться
websocketService.connect()

// Подписаться на тип сенсора
websocketService.subscribe(sensorType)

// Слушать события
websocketService.on('sensor_data', (data) => {
  // data содержит новые данные сенсора
})

websocketService.on('alert', (alert) => {
  // alert содержит новое оповещение
})

// Отключиться
websocketService.disconnect()
```

---

## Примеры использования данных

### Анализ данных сенсоров

```javascript
// В компоненте DashboardTab
const { sensorData, latestData, dataByParameter, parameters } = // данные из состояния

// Получить данные по конкретному параметру
const temperatureData = dataByParameter['temperature']

// Вычислить среднее значение
const avgTemperature = temperatureData.reduce((sum, point) => sum + point.value, 0) / temperatureData.length

// Найти максимальное значение
const maxTemperature = Math.max(...temperatureData.map(point => point.value))

// Найти минимальное значение
const minTemperature = Math.min(...temperatureData.map(point => point.value))

// Обнаружить аномалии
const anomalies = sensorData.filter(point => point.is_anomaly)
```

### Анализ KPI

```javascript
// В компоненте KPICards
const { kpis } = // данные из пропсов

// Получить конкретный KPI
const oeeKpi = kpis.find(kpi => kpi.kpi_name === 'OEE')

// Вычислить прогресс к цели
const progress = (oeeKpi.value / oeeKpi.target) * 100

// Сравнить с целевым значением
const isOnTarget = oeeKpi.value >= oeeKpi.target * 0.9
```

---

## Рекомендации для ИИ

### 1. Визуализация данных

ИИ может использовать библиотеки для создания графиков:
- Chart.js (уже установлен в проекте)
- D3.js (можно добавить)
- Recharts (можно добавить)

### 2. Анализ данных

ИИ может выполнять:
- Статистический анализ (среднее, медиана, стандартное отклонение)
- Обнаружение трендов
- Прогнозирование (линейная регрессия, машинное обучение)
- Обнаружение аномалий

### 3. Генерация рекомендаций

На основе анализа данных ИИ может генерировать:
- Рекомендации по оптимизации процессов
- Предупреждения о потенциальных проблемах
- Предложения по улучшению показателей

### 4. Real-time обновления

ИИ должен учитывать WebSocket обновления для:
- Автоматического обновления визуализаций
- Реакции на новые данные в реальном времени
- Обработки новых алертов

---

## Структура для интеграции ИИ

### Вариант 1: ИИ как отдельный сервис

Создать новый сервис `aiService.js`:
```javascript
export const aiService = {
  generateVisualizations: async (data) => {
    // Отправить данные в ИИ и получить визуализации
  },
  generateInsights: async (data) => {
    // Получить аналитические инсайты от ИИ
  },
  generateRecommendations: async (data) => {
    // Получить рекомендации от ИИ
  }
}
```

### Вариант 2: ИИ как компонент

Создать компонент `AIGeneratedContent.js`:
```javascript
const AIGeneratedContent = ({ sensorData, latestData, dataByParameter, parameters, summary, sensorType }) => {
  // ИИ логика для генерации контента
  // Возвращает JSX с визуализациями и анализом
}
```

### Вариант 3: ИИ как хук

Создать хук `useAIGeneratedContent.js`:
```javascript
const useAIGeneratedContent = (data) => {
  // ИИ логика
  // Возвращает сгенерированный контент
}
```

---

## Важные замечания

1. **Данные уже загружаются:** Все функции загрузки данных работают автоматически
2. **WebSocket подключен:** Real-time обновления уже настроены
3. **Структура готова:** Компоненты подготовлены для интеграции ИИ
4. **Комментарии добавлены:** В коде есть подробные комментарии для ИИ
5. **Отладка:** В development режиме доступны данные для отладки (скрыты по умолчанию)

---

## Следующие шаги

1. Выбрать подход к интеграции ИИ (сервис, компонент, хук)
2. Реализовать ИИ-логику для генерации контента
3. Интегрировать ИИ в функции `renderAIGeneratedContent()` и `renderAIGeneratedKPIs()`
4. Протестировать работу ИИ с реальными данными
5. Оптимизировать производительность

---

*Документация создана: 2024*

